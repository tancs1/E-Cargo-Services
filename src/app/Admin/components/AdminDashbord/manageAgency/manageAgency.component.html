
<div class=" w-full  h-[100vh] bg-[#FAFAFA]  overflow-x-hidden  pb-20">
  <div class="  md:ml-40 lg:ml-80 ml-28  text-slate-600    mt-32   flex  ">
    <div class="w-5/6 flex justify-center">
<span class="font-semibold text-4xl underline">Registered Cargo Agencies </span>
    </div>


  </div>
  <div class="md:ml-40 lg:ml-80 ml-28   mr-28   mt-24"> 
   <div class="text-end mb-5"> <button class="rounded-lg" (click)="addNewUser()" nz-button nzType="primary" ><span nz-icon nzType="plus"></span>Add New Agency </button></div>
    <nz-table #nzTable [nzData]="listOfDisplayData" nzTableLayout="fixed"  class="tableHeader">
      <thead >
        <tr >
          <th >#</th>
          <th nzCustomFilter>
            Name
            <nz-filter-trigger [(nzVisible)]="visibletable" [nzActive]="searchValue.length > 0" [nzDropdownMenu]="menu">
              <span nz-icon nzType="search"></span>
            </nz-filter-trigger>
          </th>
          <th>Email</th>
          <th>Phone Number</th>
          <th>Password</th>
          <th>company Name</th>
          <th>NTN #</th>
          <th>Address</th>
          <th>CNIC Image</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of nzTable.data; let i=index">
     <td class=" font-bold text-base">{{i+1}}</td>
          <td>{{ data.fullname }}</td>
          <td>{{ data.email }}</td>
          <td>{{ data.mobile }}</td>
          <td>{{ data.password }}</td>
          <td>{{ data.businessName }}</td>
          <td>{{ data.ntn }}</td>
         
          <td>{{ data.address }}</td>
          <td class="w-fit flex flex-col gap-3">
            <span class="underline cursor-pointer hover:text-blue-800 "(click)="onClick('front',data._id)">view front side</span>
            <span class="underline cursor-pointer hover:text-blue-800 "(click)="onClick('back',data._id)">view Back side</span>
          </td>
         
          <td class="bg-slate-200" > <div class="flex gap-8 justify-center text-base ">
            <i class="fa-regular fa-pen-to-square text-blue-700" (click)="EditAgencyDetail(data._id)"></i> 
            
            <i  nz-popconfirm nzPopconfirmTitle="Sure to delete?" (nzOnConfirm)="deleteAgency(data._id)" class="fa-regular fa-trash-can text-red-700" ></i>
          </div>
      </td>
      
        </tr>
      </tbody>
    </nz-table>
    <nz-dropdown-menu #menu="nzDropdownMenu">
      <div class="ant-table-filter-dropdown">
        <div class="search-box ">
          <input type="text" class="mt-1" (input)="search()" nz-input placeholder="Search name" [(ngModel)]="searchValue" />
<div class=" flex justify-between " >
  <span class="w-1/2 bg-slate-50 hover:bg-slate-200 text-center" nzSize="small" (click)="reset()"><img class="w-3" src="../../../../../assets/imges/rotate-left-circular-arrow-interface-symbol_32418.png" alt=""></span>
  <span  class="w-1/2 bg-slate-50 hover:bg-slate-200 text-center" (click)="closeDropdown()" nzSize="small" ><i class="fa-solid fa-xmark hover:text-red" ></i></span>
</div>
        </div>
      </div>
    </nz-dropdown-menu>
  </div>
  </div>


  <!-- drawer -->
  <nz-drawer [nzSize]="size" [nzVisible]="visible" nzPlacement="right" [nzTitle]="title" (nzOnClose)="close()">
    <ng-container *nzDrawerContent>
<div class=" w-full h-full">
  <form [formGroup]="form" >
    <div class="w-full px-10 py-5">
      <div class="w-full flex flex-col gap-6 mt-5">
        <div class="w-full">
          <label for="fullname" class="text-slate-600">Full Name</label>
          <input type="text" nz-input formControlName="fullname" placeholder="Enter Full Name" />
          <div *ngIf="submitted && f['fullname'].errors" class="text-red-600 mt-1">
            <div *ngIf="f['fullname'].errors['required']">Full Name is required</div>
          </div>
        </div>
        <div class="w-full">
          <label for="email" class="text-slate-600">Email</label>
          <input type="email" nz-input formControlName="email" placeholder="Enter Email" />
          <div *ngIf="submitted && f['email'].errors" class="text-red-600 mt-1">
            <div *ngIf="f['email'].errors['required']">Email is required</div>
            <div *ngIf="f['email'].errors['pattern']">Invalid email format</div>
          </div>
        </div>
        <div class="w-full">
          <label for="businessName" class="text-slate-600">Company Name</label>
          <input type="text" nz-input formControlName="businessName" placeholder="Enter businessName" />
          <div *ngIf="submitted && f['businessName'].errors" class="text-red-600 mt-1">
            <div *ngIf="f['businessName'].errors['required']">Company Name is required</div>
          </div>
        </div>
  
        <div class="w-full">
          <label for="address" class="text-slate-600">Address</label>
          <input type="text" nz-input formControlName="address" placeholder="Enter Address" />
          <div *ngIf="submitted && f['address'].errors" class="text-red-600 mt-1">
            <div *ngIf="f['address'].errors['required']">Address is required</div>
          </div>
        </div>
  
       
  
        <div class="w-full">
          <label for="mobile" class="text-slate-600">Phone Number</label>
          <input type="tel" nz-input formControlName="mobile" placeholder="Enter Phone Number" />
          
          <div *ngIf="submitted && f['mobile'].errors" class="text-red-600 mt-1">
            <div *ngIf="f['mobile'].errors['required']">Mobile Number is required</div>
            <div *ngIf="f['mobile'].errors['pattern']">Invalid Mobile number format</div>
          </div>
        </div>
        <div class="w-full">
          <label for="ntn" class="text-slate-600">NTN Number</label>
          <input type="tel" nz-input formControlName="ntn" placeholder="Enter Phone Number" />
          
          <div *ngIf="submitted && f['ntn'].errors" class="text-red-600 mt-1">
            <div *ngIf="f['ntn'].errors['required']">NTN Number is required</div>
            <div *ngIf="f['ntn'].errors['pattern']">Invalid NTN number format</div>
          </div>
        </div>
  
  
     
        <div class="w-full">
          <label for="password" class="text-slate-600">User Password</label>
         
          <nz-input-group [nzSuffix]="suffixTemplate">
            <input
              [type]="passwordVisible ? 'text' : 'password'"
              nz-input
              formControlName="password" placeholder="Set User Login Password"
   
            />
          </nz-input-group>
          <ng-template #suffixTemplate>
            <span
              nz-icon
              [nzType]="passwordVisible ? 'eye-invisible' : 'eye'"
              (click)="passwordVisible = !passwordVisible"
            ></span>
          </ng-template>
          <div *ngIf="submitted && f['password'].errors" class="text-red-600 mt-1">
            <div *ngIf="f['password'].errors['required']">User Password is required</div>
          </div>
        </div>
   
      </div>
  
      <div class="w-full text-center mt-16" *ngIf="drawertype==='add'" >
        <button (click)="submit()" nz-button nzType="primary" class="w-1/4 h-11 font-bold text-base rounded-lg">Submit</button>
      </div>
      <div class="w-full text-center mt-16" *ngIf="drawertype==='edit'">
        <button (click)="updateAgencyDetail()" nz-button nzType="primary" class="w-1/4 h-11 font-bold text-base rounded-lg">Update</button>
      </div>
    </div>
  </form>
  

</div>
     

    </ng-container>
</nz-drawer>
<div *ngIf="show" class="relative z-50" aria-labelledby="modal-title" role="dialog" aria-modal="true">

  <!--
    Background backdrop, show/hide based on modal state.

    Entering: "ease-out duration-300"
      From: "opacity-0"
      To: "opacity-100"
    Leaving: "ease-in duration-200"
      From: "opacity-100"
      To: "opacity-0"
  -->
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>

  <div class="fixed inset-0 z-10 w-screen overflow-y-auto">
    <span class="absolute right-7 top-4" (click)="hideimgModal()" type="button"><i class="fa-regular fa-rectangle-xmark text-3xl text-slate-200 hover:text-red-400 "></i></span>
    <div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
      <!--
        
        Modal panel, show/hide based on modal state.

        Entering: "ease-out duration-300"
          From: "opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
          To: "opacity-100 translate-y-0 sm:scale-100"
        Leaving: "ease-in duration-200"
          From: "opacity-100 translate-y-0 sm:scale-100"
          To: "opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
      -->
      <div class=" h-fit relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-fit">
        <img src={{src}} alt="">
<div class="w-full text-center">
  
  <span class=" text-2xl ">{{text}}</span>
</div>
      </div>
    </div>
  </div>
</div>